<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Á§æÂÜÖ„Ç§„É≥„Éà„É©„Éç„ÉÉ„Éà - ÊÉÖÂ†±ÂÖ±Êúâ„Çµ„Ç§„Éà</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 2.5rem;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.8);
            color: #333;
            border: 2px solid #667eea;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 30px;
            margin-bottom: 30px;
        }

        .content-area {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .sidebar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            height: fit-content;
        }

        .section {
            margin-bottom: 40px;
        }

        .section h2 {
            color: #667eea;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        .news-item, .announcement-item {
            background: linear-gradient(135deg, #f8f9ff, #e8f0ff);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            border-left: 5px solid #667eea;
            transition: all 0.3s ease;
        }

        .news-item:hover, .announcement-item:hover {
            transform: translateX(5px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.2);
        }

        .news-item h3, .announcement-item h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .date {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .quick-links {
            list-style: none;
        }

        .quick-links li {
            margin-bottom: 12px;
        }

        .quick-links a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            display: block;
            padding: 10px;
            border-radius: 10px;
        }

        .quick-links a:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: translateX(5px);
        }

        .edit-mode {
            display: none;
        }

        .edit-mode.active {
            display: block;
        }

        .edit-form {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 2px dashed #667eea;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #667eea;
        }

        .form-group input, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .editable-item {
            position: relative;
        }

        .edit-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            opacity: 1;
            transition: opacity 0.3s ease;
            z-index: 10;
        }

        .editable-item:hover .edit-controls {
            opacity: 1;
        }

        .edit-btn, .delete-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #667eea;
            color: #667eea;
            cursor: pointer;
            padding: 6px 8px;
            margin-left: 3px;
            border-radius: 6px;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .edit-btn:hover {
            background: #667eea;
            color: white;
        }

        .delete-btn {
            border-color: #dc3545;
            color: #dc3545;
        }

        .delete-btn:hover {
            background: #dc3545;
            color: white;
        }

        .footer {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            color: #666;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üè¢ Á§æÂÜÖ„Ç§„É≥„Éà„É©„Éç„ÉÉ„Éà</h1>
            <div class="header-controls">
                <span id="currentDateTime"></span>
                <button class="btn btn-primary" onclick="toggleEditMode()" id="editModeBtn">
                    üìù Á∑®ÈõÜ„É¢„Éº„Éâ
                </button>
                <div class="edit-mode" id="adminControls" style="margin-left: 15px;">
                    <button class="btn btn-secondary" onclick="exportData()" title="„Éá„Éº„Çø„ÇíJSON„Éï„Ç°„Ç§„É´„Å®„Åó„Å¶‰øùÂ≠ò">
                        üíæ „Ç®„ÇØ„Çπ„Éù„Éº„Éà
                    </button>
                    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(event)">
                    <button class="btn btn-secondary" onclick="document.getElementById('importFile').click()" title="JSON„Éï„Ç°„Ç§„É´„Åã„Çâ„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø">
                        üìÇ „Ç§„É≥„Éù„Éº„Éà
                    </button>
                </div>
            </div>
        </header>

        <main class="main-content">
            <div class="content-area">
                <!-- „ÅäÁü•„Çâ„Åõ„Çª„ÇØ„Ç∑„Éß„É≥ -->
                <section class="section">
                    <h2>üì¢ ÈáçË¶Å„Å™„ÅäÁü•„Çâ„Åõ</h2>
                    
                    <div class="edit-mode" id="announcementEditMode">
                        <div class="edit-form">
                            <h4>Êñ∞„Åó„ÅÑ„ÅäÁü•„Çâ„Åõ„ÇíËøΩÂä†</h4>
                            <div class="form-group">
                                <label>„Çø„Ç§„Éà„É´:</label>
                                <input type="text" id="announcementTitle" placeholder="„ÅäÁü•„Çâ„Åõ„ÅÆ„Çø„Ç§„Éà„É´„ÇíÂÖ•Âäõ">
                            </div>
                            <div class="form-group">
                                <label>ÂÜÖÂÆπ:</label>
                                <textarea id="announcementContent" placeholder="„ÅäÁü•„Çâ„Åõ„ÅÆÂÜÖÂÆπ„ÇíÂÖ•Âäõ"></textarea>
                            </div>
                            <button class="btn btn-primary" onclick="addAnnouncement()">ËøΩÂä†</button>
                        </div>
                    </div>

                    <div id="announcementsList">
                        <div class="announcement-item editable-item fade-in">
                            <div class="edit-controls">
                                <button class="edit-btn" onclick="editItem(this, 'announcement')">‚úèÔ∏è</button>
                                <button class="delete-btn" onclick="deleteItem(this)">üóëÔ∏è</button>
                            </div>
                            <h3>Âπ¥Êú´Âπ¥Âßã‰ºëÊöá„Å´„Å§„ÅÑ„Å¶</h3>
                            <div class="date">2025Âπ¥8Êúà8Êó•</div>
                            <p>Âπ¥Êú´Âπ¥Âßã„ÅÆ‰ºëÊöáÊúüÈñì„ÅØ12Êúà29Êó•ÔΩû1Êúà3Êó•„Å®„Å™„Çä„Åæ„Åô„ÄÇÁ∑äÊÄ•ÊôÇ„ÅÆÈÄ£Áµ°ÂÖà„Å´„Å§„ÅÑ„Å¶„ÅØÂà•ÈÄî„ÅäÁü•„Çâ„Åõ„ÅÑ„Åü„Åó„Åæ„Åô„ÄÇ</p>
                        </div>

                        <div class="announcement-item editable-item fade-in">
                            <div class="edit-controls">
                                <button class="edit-btn" onclick="editItem(this, 'announcement')">‚úèÔ∏è</button>
                                <button class="delete-btn" onclick="deleteItem(this)">üóëÔ∏è</button>
                            </div>
                            <h3>Êñ∞„Ç∑„Çπ„ÉÜ„É†Â∞éÂÖ•„ÅÆ„ÅäÁü•„Çâ„Åõ</h3>
                            <div class="date">2025Âπ¥8Êúà5Êó•</div>
                            <p>Êù•Êúà„Çà„ÇäÊñ∞„Åó„ÅÑÂã§ÊÄ†ÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†„ÅåÂ∞éÂÖ•„Åï„Çå„Åæ„Åô„ÄÇË©≥Á¥∞„Å™‰ΩøÁî®ÊñπÊ≥ï„Å´„Å§„ÅÑ„Å¶„ÅØËøΩ„Å£„Å¶Ë™¨Êòé‰ºö„ÇíÈñãÂÇ¨„ÅÑ„Åü„Åó„Åæ„Åô„ÄÇ</p>
                        </div>
                    </div>
                </section>

                <!-- „Éã„É•„Éº„Çπ„Çª„ÇØ„Ç∑„Éß„É≥ -->
                <section class="section">
                    <h2>üì∞ Á§æÂÜÖ„Éã„É•„Éº„Çπ</h2>
                    
                    <div class="edit-mode" id="newsEditMode">
                        <div class="edit-form">
                            <h4>Êñ∞„Åó„ÅÑ„Éã„É•„Éº„Çπ„ÇíËøΩÂä†</h4>
                            <div class="form-group">
                                <label>„Çø„Ç§„Éà„É´:</label>
                                <input type="text" id="newsTitle" placeholder="„Éã„É•„Éº„Çπ„ÅÆ„Çø„Ç§„Éà„É´„ÇíÂÖ•Âäõ">
                            </div>
                            <div class="form-group">
                                <label>ÂÜÖÂÆπ:</label>
                                <textarea id="newsContent" placeholder="„Éã„É•„Éº„Çπ„ÅÆÂÜÖÂÆπ„ÇíÂÖ•Âäõ"></textarea>
                            </div>
                            <button class="btn btn-primary" onclick="addNews()">ËøΩÂä†</button>
                        </div>
                    </div>

                    <div id="newsList">
                        <div class="news-item editable-item fade-in">
                            <div class="edit-controls">
                                <button class="edit-btn" onclick="editItem(this, 'news')">‚úèÔ∏è</button>
                                <button class="delete-btn" onclick="deleteItem(this)">üóëÔ∏è</button>
                            </div>
                            <h3>Á¨¨3ÂõõÂçäÊúüÊ•≠Á∏æÁô∫Ë°®</h3>
                            <div class="date">2025Âπ¥8Êúà7Êó•</div>
                            <p>Á¨¨3ÂõõÂçäÊúü„ÅÆÊ•≠Á∏æ„ÅåÂâçÂπ¥ÂêåÊúüÊØî15%Â¢ó„Å®„Å™„Çä„Åæ„Åó„Åü„ÄÇÂÖ®Á§æÂì°„ÅÆÂä™Âäõ„Å´„Çà„ÇäÁ¥†Êô¥„Çâ„Åó„ÅÑÁµêÊûú„ÇíÈÅîÊàê„Åß„Åç„Åæ„Åó„Åü„ÄÇ</p>
                        </div>

                        <div class="news-item editable-item fade-in">
                            <div class="edit-controls">
                                <button class="edit-btn" onclick="editItem(this, 'news')">‚úèÔ∏è</button>
                                <button class="delete-btn" onclick="deleteItem(this)">üóëÔ∏è</button>
                            </div>
                            <h3>Êñ∞ÂÖ•Á§æÂì°Ê≠ìËøé‰ºöÈñãÂÇ¨</h3>
                            <div class="date">2025Âπ¥8Êúà3Êó•</div>
                            <p>8Êúà15Êó•„Å´Êñ∞ÂÖ•Á§æÂì°Ê≠ìËøé‰ºö„ÇíÈñãÂÇ¨„Åó„Åæ„Åô„ÄÇ‰ºöÂ†¥„ÅØÊú¨Á§æ1Èöé„Ç´„Éï„Çß„ÉÜ„É™„Ç¢„Åß„Åô„ÄÇÂ§ö„Åè„ÅÆÁöÜÊßò„ÅÆ„ÅîÂèÇÂä†„Çí„ÅäÂæÖ„Å°„Åó„Å¶„Åä„Çä„Åæ„Åô„ÄÇ</p>
                        </div>
                    </div>
                </section>
            </div>

            <aside class="sidebar">
                <h3 style="color: #667eea; margin-bottom: 20px;">üîó „ÇØ„Ç§„ÉÉ„ÇØ„É™„É≥„ÇØ</h3>
                <ul class="quick-links" id="quickLinksList">
                    <li><a href="#" onclick="showAlert('‰∫∫‰∫ã„Ç∑„Çπ„ÉÜ„É†')">üë• ‰∫∫‰∫ã„Ç∑„Çπ„ÉÜ„É†</a></li>
                    <li><a href="#" onclick="showAlert('ÁµåË≤ªÁ≤æÁÆó')">üí∞ ÁµåË≤ªÁ≤æÁÆó</a></li>
                    <li><a href="#" onclick="showAlert('‰ºöË≠∞ÂÆ§‰∫àÁ¥Ñ')">üè¢ ‰ºöË≠∞ÂÆ§‰∫àÁ¥Ñ</a></li>
                    <li><a href="#" onclick="showAlert('Á§æÂÜÖWiki')">üìö Á§æÂÜÖWiki</a></li>
                    <li><a href="#" onclick="showAlert('IT „Çµ„Éù„Éº„Éà')">üîß IT „Çµ„Éù„Éº„Éà</a></li>
                </ul>

                <div class="edit-mode" id="linkEditMode" style="margin-top: 20px;">
                    <div class="edit-form">
                        <h4>„É™„É≥„ÇØ„ÇíËøΩÂä†</h4>
                        <div class="form-group">
                            <label>„É™„É≥„ÇØÂêç:</label>
                            <input type="text" id="linkName" placeholder="„É™„É≥„ÇØÂêç„ÇíÂÖ•Âäõ">
                        </div>
                        <button class="btn btn-secondary" onclick="addLink()">ËøΩÂä†</button>
                    </div>
                </div>

                <div style="margin-top: 30px;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">üìä ‰ªäÊó•„ÅÆÊÉÖÂ†±</h3>
                    <div style="background: linear-gradient(135deg, #f8f9ff, #e8f0ff); padding: 15px; border-radius: 15px;">
                        <p><strong>‰ªäÊó•„ÅÆÂ§©Ê∞ó:</strong> ‚òÄÔ∏è Êô¥„Çå</p>
                        <p><strong>Ê∞óÊ∏©:</strong> 28¬∞C</p>
                        <p><strong>Âá∫Âã§ËÄÖÊï∞:</strong> <span id="attendanceCount">156</span>Âêç</p>
                    </div>
                </div>

                <div class="edit-mode" id="dataManagement" style="margin-top: 25px;">
                    <div style="background: #f8f9ff; padding: 15px; border-radius: 15px; border: 2px dashed #667eea;">
                        <h4 style="color: #667eea; margin-bottom: 10px;">üì§ „Éá„Éº„ÇøÂÖ±Êúâ</h4>
                        <p style="font-size: 0.9rem; color: #666; margin-bottom: 10px;">
                            Á∑®ÈõÜ„Åó„ÅüÂÜÖÂÆπ„Çí‰ªñ„ÅÆ„É¶„Éº„Ç∂„Éº„Å®ÂÖ±Êúâ„Åß„Åç„Åæ„Åô
                        </p>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <button class="btn btn-primary" onclick="exportData()" style="font-size: 0.8rem; padding: 8px 16px;">
                                üíæ „Ç®„ÇØ„Çπ„Éù„Éº„Éà
                            </button>
                            <button class="btn btn-secondary" onclick="resetData()" style="font-size: 0.8rem; padding: 8px 16px;">
                                üîÑ „É™„Çª„ÉÉ„Éà
                            </button>
                        </div>
                    </div>
                </div>
            </aside>
        </main>

        <footer class="footer">
            <p>&copy; 2025 Ê†™Âºè‰ºöÁ§æ„Çµ„É≥„Éó„É´ - Á§æÂÜÖ„Ç§„É≥„Éà„É©„Éç„ÉÉ„Éà | ÊúÄÁµÇÊõ¥Êñ∞: <span id="lastUpdate"></span></p>
        </footer>
    </div>

    <script>
        let isEditMode = false;

        // „Éá„Éº„Çø„Çí‰øùÂ≠ò„ÉªË™≠„ÅøËæº„Åø„Åô„ÇãÈñ¢Êï∞
        function saveData() {
            const data = {
                announcements: [],
                news: [],
                quickLinks: []
            };
            
            // „ÅäÁü•„Çâ„Åõ„Éá„Éº„Çø„ÇíÂèéÈõÜ
            document.querySelectorAll('#announcementsList .announcement-item').forEach(item => {
                const title = item.querySelector('h3').textContent;
                const date = item.querySelector('.date').textContent;
                const content = item.querySelector('p').textContent;
                data.announcements.push({ title, date, content });
            });
            
            // „Éã„É•„Éº„Çπ„Éá„Éº„Çø„ÇíÂèéÈõÜ
            document.querySelectorAll('#newsList .news-item').forEach(item => {
                const title = item.querySelector('h3').textContent;
                const date = item.querySelector('.date').textContent;
                const content = item.querySelector('p').textContent;
                data.news.push({ title, date, content });
            });
            
            // „ÇØ„Ç§„ÉÉ„ÇØ„É™„É≥„ÇØ„Éá„Éº„Çø„ÇíÂèéÈõÜ
            document.querySelectorAll('#quickLinksList li a').forEach(link => {
                const name = link.textContent;
                data.quickLinks.push({ name });
            });
            
            // „Éñ„É©„Ç¶„Ç∂„ÅÆ„É°„É¢„É™„Å´‰øùÂ≠ò
            try {
                window.intranetData = data;
            } catch (e) {
                // „Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„ÅüÂ†¥Âêà„ÅÆ„Åø„Ç¢„É©„Éº„ÉàË°®Á§∫
                if (e.message) {
                    alert('„Éá„Éº„Çø„ÅÆ‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                }
            }
        }

        function loadData() {
            try {
                const data = window.intranetData;
                if (!data) return;
                
                // „ÅäÁü•„Çâ„Åõ„ÇíÂæ©ÂÖÉ
                const announcementsList = document.getElementById('announcementsList');
                announcementsList.innerHTML = '';
                data.announcements.forEach(item => {
                    const announcementHtml = createAnnouncementHtml(item.title, item.date, item.content);
                    announcementsList.insertAdjacentHTML('beforeend', announcementHtml);
                });
                
                // „Éã„É•„Éº„Çπ„ÇíÂæ©ÂÖÉ
                const newsList = document.getElementById('newsList');
                newsList.innerHTML = '';
                data.news.forEach(item => {
                    const newsHtml = createNewsHtml(item.title, item.date, item.content);
                    newsList.insertAdjacentHTML('beforeend', newsHtml);
                });
                
                // „ÇØ„Ç§„ÉÉ„ÇØ„É™„É≥„ÇØ„ÇíÂæ©ÂÖÉ
                const quickLinksList = document.getElementById('quickLinksList');
                quickLinksList.innerHTML = '';
                data.quickLinks.forEach(item => {
                    const linkHtml = `<li><a href="#" onclick="showAlert('${item.name}')">${item.name}</a></li>`;
                    quickLinksList.insertAdjacentHTML('beforeend', linkHtml);
                });
                
            } catch (e) {
                // ÂàùÊúü„Éá„Éº„Çø„ÇíË®≠ÂÆö
                loadDefaultData();
            }
        }

        function loadDefaultData() {
            // ÂàùÊúü„ÅÆ„ÅäÁü•„Çâ„Åõ„Éá„Éº„Çø
            const defaultAnnouncements = [
                {
                    title: 'Âπ¥Êú´Âπ¥Âßã‰ºëÊöá„Å´„Å§„ÅÑ„Å¶',
                    date: '2025Âπ¥8Êúà8Êó•',
                    content: 'Âπ¥Êú´Âπ¥Âßã„ÅÆ‰ºëÊöáÊúüÈñì„ÅØ12Êúà29Êó•ÔΩû1Êúà3Êó•„Å®„Å™„Çä„Åæ„Åô„ÄÇÁ∑äÊÄ•ÊôÇ„ÅÆÈÄ£Áµ°ÂÖà„Å´„Å§„ÅÑ„Å¶„ÅØÂà•ÈÄî„ÅäÁü•„Çâ„Åõ„ÅÑ„Åü„Åó„Åæ„Åô„ÄÇ'
                },
                {
                    title: 'Êñ∞„Ç∑„Çπ„ÉÜ„É†Â∞éÂÖ•„ÅÆ„ÅäÁü•„Çâ„Åõ',
                    date: '2025Âπ¥8Êúà5Êó•',
                    content: 'Êù•Êúà„Çà„ÇäÊñ∞„Åó„ÅÑÂã§ÊÄ†ÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†„ÅåÂ∞éÂÖ•„Åï„Çå„Åæ„Åô„ÄÇË©≥Á¥∞„Å™‰ΩøÁî®ÊñπÊ≥ï„Å´„Å§„ÅÑ„Å¶„ÅØËøΩ„Å£„Å¶Ë™¨Êòé‰ºö„ÇíÈñãÂÇ¨„ÅÑ„Åü„Åó„Åæ„Åô„ÄÇ'
                }
            ];

            // ÂàùÊúü„ÅÆ„Éã„É•„Éº„Çπ„Éá„Éº„Çø
            const defaultNews = [
                {
                    title: 'Á¨¨3ÂõõÂçäÊúüÊ•≠Á∏æÁô∫Ë°®',
                    date: '2025Âπ¥8Êúà7Êó•',
                    content: 'Á¨¨3ÂõõÂçäÊúü„ÅÆÊ•≠Á∏æ„ÅåÂâçÂπ¥ÂêåÊúüÊØî15%Â¢ó„Å®„Å™„Çä„Åæ„Åó„Åü„ÄÇÂÖ®Á§æÂì°„ÅÆÂä™Âäõ„Å´„Çà„ÇäÁ¥†Êô¥„Çâ„Åó„ÅÑÁµêÊûú„ÇíÈÅîÊàê„Åß„Åç„Åæ„Åó„Åü„ÄÇ'
                },
                {
                    title: 'Êñ∞ÂÖ•Á§æÂì°Ê≠ìËøé‰ºöÈñãÂÇ¨',
                    date: '2025Âπ¥8Êúà3Êó•',
                    content: '8Êúà15Êó•„Å´Êñ∞ÂÖ•Á§æÂì°Ê≠ìËøé‰ºö„ÇíÈñãÂÇ¨„Åó„Åæ„Åô„ÄÇ‰ºöÂ†¥„ÅØÊú¨Á§æ1Èöé„Ç´„Éï„Çß„ÉÜ„É™„Ç¢„Åß„Åô„ÄÇÂ§ö„Åè„ÅÆÁöÜÊßò„ÅÆ„ÅîÂèÇÂä†„Çí„ÅäÂæÖ„Å°„Åó„Å¶„Åä„Çä„Åæ„Åô„ÄÇ'
                }
            ];

            // ÂàùÊúü„ÅÆ„ÇØ„Ç§„ÉÉ„ÇØ„É™„É≥„ÇØ„Éá„Éº„Çø
            const defaultLinks = [
                { name: 'üë• ‰∫∫‰∫ã„Ç∑„Çπ„ÉÜ„É†' },
                { name: 'üí∞ ÁµåË≤ªÁ≤æÁÆó' },
                { name: 'üè¢ ‰ºöË≠∞ÂÆ§‰∫àÁ¥Ñ' },
                { name: 'üìö Á§æÂÜÖWiki' },
                { name: 'üîß IT „Çµ„Éù„Éº„Éà' }
            ];

            window.intranetData = {
                announcements: defaultAnnouncements,
                news: defaultNews,
                quickLinks: defaultLinks
            };
        }

        // HTML„ÇíÁîüÊàê„Åô„ÇãÈñ¢Êï∞
        function createAnnouncementHtml(title, date, content) {
            return `
                <div class="announcement-item editable-item fade-in">
                    <div class="edit-controls">
                        <button class="edit-btn" onclick="editItem(this, 'announcement')" type="button">‚úèÔ∏è</button>
                        <button class="delete-btn" onclick="deleteItem(this)" type="button">üóëÔ∏è</button>
                    </div>
                    <h3>${escapeHtml(title)}</h3>
                    <div class="date">${escapeHtml(date)}</div>
                    <p>${escapeHtml(content)}</p>
                </div>
            `;
        }

        function createNewsHtml(title, date, content) {
            return `
                <div class="news-item editable-item fade-in">
                    <div class="edit-controls">
                        <button class="edit-btn" onclick="editItem(this, 'news')" type="button">‚úèÔ∏è</button>
                        <button class="delete-btn" onclick="deleteItem(this)" type="button">üóëÔ∏è</button>
                    </div>
                    <h3>${escapeHtml(title)}</h3>
                    <div class="date">${escapeHtml(date)}</div>
                    <p>${escapeHtml(content)}</p>
                </div>
            `;
        }

        // HTML„Ç®„Çπ„Ç±„Éº„ÉóÈñ¢Êï∞
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ÁèæÂú®„ÅÆÊó•ÊôÇ„ÇíË°®Á§∫
        function updateDateTime() {
            const now = new Date();
            const dateTimeString = now.toLocaleDateString('ja-JP', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                weekday: 'long',
                hour: '2-digit',
                minute: '2-digit'
            });
            document.getElementById('currentDateTime').textContent = dateTimeString;
            document.getElementById('lastUpdate').textContent = now.toLocaleDateString('ja-JP');
        }

        // Á∑®ÈõÜ„É¢„Éº„Éâ„ÅÆÂàá„ÇäÊõø„Åà
        function toggleEditMode() {
            isEditMode = !isEditMode;
            const editModes = document.querySelectorAll('.edit-mode');
            const editBtn = document.getElementById('editModeBtn');
            
            editModes.forEach(mode => {
                if (isEditMode) {
                    mode.classList.add('active');
                } else {
                    mode.classList.remove('active');
                }
            });
            
            editBtn.textContent = isEditMode ? 'üëÅÔ∏è Ë°®Á§∫„É¢„Éº„Éâ' : 'üìù Á∑®ÈõÜ„É¢„Éº„Éâ';
            editBtn.className = isEditMode ? 'btn btn-secondary' : 'btn btn-primary';
        }

        // „ÅäÁü•„Çâ„Åõ„ÇíËøΩÂä†
        function addAnnouncement() {
            const title = document.getElementById('announcementTitle').value;
            const content = document.getElementById('announcementContent').value;
            
            if (title && content) {
                const today = new Date().toLocaleDateString('ja-JP');
                const announcementHtml = createAnnouncementHtml(title, today, content);
                
                document.getElementById('announcementsList').insertAdjacentHTML('afterbegin', announcementHtml);
                document.getElementById('announcementTitle').value = '';
                document.getElementById('announcementContent').value = '';
                
                // „Éá„Éº„Çø„Çí‰øùÂ≠ò
                saveData();
            } else {
                alert('„Çø„Ç§„Éà„É´„Å®ÂÜÖÂÆπ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
            }
        }

        // „Éã„É•„Éº„Çπ„ÇíËøΩÂä†
        function addNews() {
            const title = document.getElementById('newsTitle').value;
            const content = document.getElementById('newsContent').value;
            
            if (title && content) {
                const today = new Date().toLocaleDateString('ja-JP');
                const newsHtml = createNewsHtml(title, today, content);
                
                document.getElementById('newsList').insertAdjacentHTML('afterbegin', newsHtml);
                document.getElementById('newsTitle').value = '';
                document.getElementById('newsContent').value = '';
                
                // „Éá„Éº„Çø„Çí‰øùÂ≠ò
                saveData();
            } else {
                alert('„Çø„Ç§„Éà„É´„Å®ÂÜÖÂÆπ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
            }
        }

        // „É™„É≥„ÇØ„ÇíËøΩÂä†
        function addLink() {
            const linkName = document.getElementById('linkName').value;
            
            if (linkName) {
                const linkHtml = `<li><a href="#" onclick="showAlert('${linkName}')">${linkName}</a></li>`;
                document.getElementById('quickLinksList').insertAdjacentHTML('beforeend', linkHtml);
                document.getElementById('linkName').value = '';
                
                // „Éá„Éº„Çø„Çí‰øùÂ≠ò
                saveData();
            } else {
                alert('„É™„É≥„ÇØÂêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
            }
        }

        // „Ç¢„Ç§„ÉÜ„É†„ÇíÁ∑®ÈõÜ
        function editItem(button, type) {
            const item = button.closest('.editable-item');
            const title = item.querySelector('h3').textContent;
            const content = item.querySelector('p').textContent;
            
            const newTitle = prompt('„Çø„Ç§„Éà„É´„ÇíÁ∑®ÈõÜ:', title);
            const newContent = prompt('ÂÜÖÂÆπ„ÇíÁ∑®ÈõÜ:', content);
            
            if (newTitle !== null && newContent !== null) {
                item.querySelector('h3').textContent = newTitle;
                item.querySelector('p').textContent = newContent;
                
                // Êó•‰ªò„ÇíÊõ¥Êñ∞
                const today = new Date().toLocaleDateString('ja-JP');
                item.querySelector('.date').textContent = today;
                
                // „Éá„Éº„Çø„Çí‰øùÂ≠ò
                saveData();
            }
        }

        // „Ç¢„Ç§„ÉÜ„É†„ÇíÂâäÈô§
        function deleteItem(button) {
            if (confirm('„Åì„ÅÆÈ†ÖÁõÆ„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
                const item = button.closest('.editable-item');
                item.style.opacity = '0';
                item.style.transform = 'translateX(-20px)';
                setTimeout(() => {
                    item.remove();
                    // „Éá„Éº„Çø„Çí‰øùÂ≠ò
                    saveData();
                }, 300);
            }
        }

        // „Ç¢„É©„Éº„ÉàË°®Á§∫Ôºà„É™„É≥„ÇØ„ÇØ„É™„ÉÉ„ÇØÊôÇÔºâ
        function showAlert(linkName) {
            alert(`${linkName} „ÅÆ„Éö„Éº„Ç∏„Å´ÁßªÂãï„Åó„Åæ„Åô„ÄÇ`);
        }

        // Âá∫Âã§ËÄÖÊï∞„Çí„É©„É≥„ÉÄ„É†„Å´Â§âÊõ¥Ôºà„Éá„É¢Áî®Ôºâ
        function updateAttendance() {
            const count = Math.floor(Math.random() * 50) + 140;
            document.getElementById('attendanceCount').textContent = count;
        }

        // ÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            // ÂàùÊúü„Éá„Éº„Çø„ÇíË®≠ÂÆö
            loadDefaultData();
            
            // ‰øùÂ≠ò„Åï„Çå„Åü„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø
            loadData();
            
            updateDateTime();
            setInterval(updateDateTime, 60000); // 1ÂàÜ„Åî„Å®„Å´Êõ¥Êñ∞
            setInterval(updateAttendance, 30000); // 30Áßí„Åî„Å®„Å´Âá∫Âã§ËÄÖÊï∞„ÇíÊõ¥Êñ∞
        });

        // „Éá„Éº„Çø„Çí„Ç®„ÇØ„Çπ„Éù„Éº„Éà„Åô„ÇãÊ©üËÉΩÔºàÁÆ°ÁêÜËÄÖÁî®Ôºâ
        function exportData() {
            // ÊúÄÊñ∞„ÅÆ„Éá„Éº„Çø„Çí‰øùÂ≠ò„Åó„Å¶„Åã„Çâ„Ç®„ÇØ„Çπ„Éù„Éº„Éà
            saveData();
            
            if (window.intranetData) {
                // „Ç®„ÇØ„Çπ„Éù„Éº„ÉàÊÉÖÂ†±„ÇíËøΩÂä†
                const exportData = {
                    ...window.intranetData,
                    exportDate: new Date().toISOString(),
                    version: "1.0"
                };
                
                const dataStr = JSON.stringify(exportData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                
                // „Éï„Ç°„Ç§„É´Âêç„Å´Êó•‰ªò„ÇíÂê´„ÇÅ„Çã
                const dateStr = new Date().toISOString().split('T')[0];
                link.download = `intranet_data_${dateStr}.json`;
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                alert('„Éá„Éº„Çø„Çí„Ç®„ÇØ„Çπ„Éù„Éº„Éà„Åó„Åæ„Åó„ÅüÔºÅ\n\n„Åì„ÅÆ„Éï„Ç°„Ç§„É´„Çí‰ªñ„ÅÆ„É¶„Éº„Ç∂„Éº„Å®ÂÖ±Êúâ„Åó„Å¶„ÄÅ„Äå„Ç§„É≥„Éù„Éº„Éà„Äç„Éú„Çø„É≥„ÅßË™≠„ÅøËæº„Çì„Åß„ÇÇ„Çâ„Å£„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
            }
        }

        // „Éá„Éº„Çø„Çí„Ç§„É≥„Éù„Éº„Éà„Åô„ÇãÊ©üËÉΩ
        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    // „Éá„Éº„Çø„ÅÆÂΩ¢Âºè„Çí„ÉÅ„Çß„ÉÉ„ÇØ
                    if (!importedData.announcements || !importedData.news || !importedData.quickLinks) {
                        throw new Error('Invalid data format');
                    }
                    
                    // „Éá„Éº„Çø„ÇíÈÅ©Áî®
                    window.intranetData = {
                        announcements: importedData.announcements,
                        news: importedData.news,
                        quickLinks: importedData.quickLinks
                    };
                    
                    // ÁîªÈù¢„ÇíÊõ¥Êñ∞
                    loadData();
                    
                    // „Ç§„É≥„Éù„Éº„ÉàÊÉÖÂ†±„ÇíË°®Á§∫
                    const importInfo = importedData.exportDate 
                        ? `\n‰ΩúÊàêÊó•ÊôÇ: ${new Date(importedData.exportDate).toLocaleString('ja-JP')}`
                        : '';
                    
                    alert(`„Éá„Éº„Çø„Çí„Ç§„É≥„Éù„Éº„Éà„Åó„Åæ„Åó„ÅüÔºÅ${importInfo}\n\n„Éö„Éº„Ç∏„ÅåÊõ¥Êñ∞„Åï„Çå„Åæ„Åó„Åü„ÄÇ`);
                    
                } catch (error) {
                    alert('„Éï„Ç°„Ç§„É´„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇÊ≠£„Åó„ÅÑJSON„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                    console.error('Import error:', error);
                }
            };
            
            reader.readAsText(file);
            // „Éï„Ç°„Ç§„É´ÈÅ∏Êäû„Çí„É™„Çª„ÉÉ„Éà
            event.target.value = '';
        }

        // „Éá„Éº„Çø„É™„Çª„ÉÉ„ÉàÊ©üËÉΩÔºàÁÆ°ÁêÜËÄÖÁî®Ôºâ
        function resetData() {
            if (confirm('„Åô„Åπ„Å¶„ÅÆ„Éá„Éº„Çø„ÇíÂàùÊúüÁä∂ÊÖã„Å´„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åô„ÅãÔºü„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇ')) {
                window.intranetData = null;
                loadDefaultData();
                loadData();
                alert('„Éá„Éº„Çø„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åó„Åü„ÄÇ');
            }
        }
    </script>
</body>
</html>
